import openai
from api.utils.secrets import api_key

client = openai.OpenAI(
    # This is the default and can be omitted
    api_key=api_key
)

titles = [
      "유세 때 버젓이…\"트럼프 '저속한 말' 탓 정신상태 우려 증폭\"",
      "50년 된 발전소 돌리는 쿠바…수백만명 덮친 정전사태 사흘째(종합)",
      "러, 젤렌스키 고향 공습…우크라는 러 본토 드론 공격(종합)",
      "독일서 이스라엘 대사관 공격 모의 리비아인 체포",
      "몰도바, 러 매표의혹 속 대선…친서방 정권 재선 관심",
      "日이시바 지지율 한주새 0.6%p↓…총선 D-7 여야 격차줄어",
      "남아공 한국영화·음식축제에 4천여명 성황",
      "젤렌스키 '우크라 나토가입 초청받으면 푸틴 전쟁 끝낸다' 주장",
      "한총리 \"전 세계, 한국과 협력 원해\"…자카르타서 동포간담회",
      "'하늘의 암살자' 띄웠다…\"미국, 하마스 지도부 추적 지원\"",
      "이스라엘군, 베이루트 공습…\"헤즈볼라 정보사령부 겨냥\"",
      "머스크 \"표현자유·총기옹호 서명자 매일 1명 뽑아 14억원 준다\"",
      "필리핀 거주 미국인, 경찰 가장 무장괴한 총 맞고 납치돼(종합)",
      "러, 우크라이나 곳곳 공습…젤렌스키 고향서 17명 부상",
      "신와르 사망에도…휴전 협상은커녕 가자·레바논 전쟁 격화",
      "현대차 22일 인도 상장…아태시장 IPO '블록버스터 주간' 앞둬",
      "유엔 \"가자북부 주민들, 이스라엘 포위 속 '말로못할 공포'\"",
      "신와르 사망 후 이스라엘서 대규모 시위 \"하마스와 협상하라\"",
      "세계의 날씨(10월20일)",
      "[연합뉴스 이 시각 헤드라인] - 15:00",
      "방글라 \"'유혈진압' 하시나 前총리 정당 정치참여 제한\"",
      "프라보워 인니 대통령 취임…\"문제 바라보고 해결하겠다\"",
      "\"대만, 中 견제 속 페루 APEC에 전직 행정원 부원장 파견\"",
      "대만, 中해경 대응 위해 7년간 1천t급 함정 11척 건조 추진",
      "'대선 승리 도와달라'…트럼프, 미디어 재벌 머독에 SOS",
      "中학자 \"한강 작품에 신기한 힘…노벨상 수상 우연 아냐\"",
      "北, '자제 강조' 유엔에 \"전면배격…무인기 침투 南 규탄하라\"",
      "印, 美와 핵심광물 협약 추진…\"글로벌 지배력 유지 中 겨냥\"",
      "필리핀 거주 미국인, 경찰 가장 무장괴한 총 맞고 납치돼",
      "[영상] 27초 영상·한글설문지…속속 드러나는 북한군 러 파병 증거",
      "시진핑 방문 中안후이성서 이주노동자 주택 화재로 9명 사망",
      "美의원들, 日에 대중국 반도체 제재 압박…\"기존 통제효과 미흡\"",
      "미국·필리핀, 中 '대만 포위훈련' 직후 남중국해서 실사격 훈련",
      "50년 된 발전소 돌리는 쿠바…24시간도 안 돼 또 정전",
      "소니·혼다, 2026년 출시 전기차에 AI 탑재…자율주행 성능 향상",
      "'저항의 축' 반격 카드는 드론…네타냐후 자택까지 노렸다",
      "미국 조지아주 페리 선착장 무너져…\"최소 7명 사망\"",
      "미일 국방장관 첫 회담…대중국 억제력·대처력 강화",
      "[연합뉴스 이 시각 헤드라인] - 10:30",
      "美 한해 재정적자 1조8천억달러…세계 공공부채 100조달러 전망",
      "트럼프 \"바이든 외교정책 반대로만 하면 최고될 것\"",
      "英외무 \"北, 러 지원하며 지역 안보도 위협…韓과 협력강화\"",
      "신와르 제거 후에도…\"이스라엘 공격에 가자 북부서 73명 사망\"",
      "장흥군, 한강 아버지 한승원 생가 매입해 '문학특구 거점' 조성",
      "해리스, 트럼프 향해 \"타인의 슬픔 경시…잔인하다\" 맹공(종합)",
      "세계의 날씨(10월20일)",
      "\"'이스라엘의 이란 보복공격 계획' 美기밀정보 온라인 유출\"",
      "LA총영사관 국감서 한인타운 치안 지적…\"현지경찰과 협력해야\"",
      "이란 \"네타냐후 자택 드론 공격, 헤즈볼라가 했다\"",
      "[인터뷰] 노벨의 나라 스웨덴 언어로 한강 번역한 칼손·박옥경 부부",
      "영국서 韓전문가 탄생한다…현지대학 한국학 전공·연구 활발",
      "러시아, 파병 북한군에 한글 설문지…\"조선씩 치수 적으세요\"",
      "[특파원 시선] 미국의 '파위네브미애즈갠' 대통령 선거",
      "푸틴·시진핑·모디…22일 러시아서 브릭스 정상회의 개막",
      "[인터뷰] 유진철 美공화 연방하원의원 후보 \"트럼프 무난 승리 예상\"",
      "[인터뷰] 데이비드김 美민주 하원의원후보 \"트럼프 집권시 무소불위 우려\"",
      "[뉴욕증시-주간전망] 실적이 온다…테슬라 등 출격",
      "野차지호 \"유승준 비자발급 거부 왜?\"…주LA총영사 \"적법\"",
      "에르도안 \"서방, 기쁨에 겨워 뛴다\"…이스라엘 맹비난",
      "美 비트코인 현물 ETF 투자자 다수는 ETF 첫 거래자",
      "美국방 \"北파병 보도 확인 안돼…사실이면 우려\"(종합)",
      "해리스, 미시간서 사전투표 독려…\"디트로이트서도 기록 경신\"",
      "이스라엘 \"신와르, 10·7 기습 전날 밤 땅굴로 피신\"(종합)",
      "네타냐후 자택에 드론 공격…\"암살 기도, 중대한 실수\"(종합2보)",
      "美국방 \"北파병 보도 확인 안돼…사실이면 우려\"",
      "美보잉 노사, 임금 4년간 35% 인상안 잠정타결…파업 종결 수순",
      "美정부 이자부담 비중 28년만에 최대…차기정부 부담 우려",
      "이스라엘군, 가자에 신와르 시신 이미지 전단 살포",
      "해리스, 흑인 지지 회복세…\"트럼프 성공은 신화에 불과\"",
      "英해협 건넌 보트난민 \"6시간 바다에…시작도 끝도 안 보여\"",
      "독일 테슬라 이어 벤츠도 \"병가 너무 많이 쓴다\"",
      "\"낙태는 살인\" 교황 발언에 벨기에서 세례 취소 운동",
      "中, 12월부터 이중용도 품목 수출통제 대폭 강화…서방에 맞불",
      "\"터널서 수거한 소변서 신와르 DNA 확인\"…이스라엘의 추격전",
      "\"트럼프 복귀 대비…美, 우크라에 27조원 대출지원 의향\"",
      "이란 외무 \"美, 이스라엘의 보복 계획 안다고? 책임져야\"(종합)",
      "미얀마 만달레이 中영사관에 폭탄 테러…\"인명피해 없어\"",
      "네타냐후 자택에 레바논發 드론 공격…\"총리 없었다\"(종합)",
      "러 전문가들 \"北파병, 큰 도움 안돼…동원령은 미룰 것\"",
      "주독 미군 살인 혐의 무죄 판결…기지 앞 규탄시위",
      "프랑스·우크라 외무 \"北파병, 확전 위험\" 우려",
      "인종 정체성 흐릿해진 미국…더 복잡해진 대선",
      "\"늙고 미친 트럼프\"…해리스 지원 나선 오바마, 트럼프 맹폭",
      "이란 외무 \"美, 이스라엘의 보복 계획 안다고? 책임져야\"",
      "시진핑, 로켓군 부대 방문…\"억지력·전투능력 강화\" 촉구",
      "\"신와르 제거한 이스라엘, 美대선 전 중동질서 재편 노린다\"",
      "佛, 이스라엘 '달래기'…방산박람회 참가 불허→조건부 허용",
      "러 \"獨숄츠 총리 대화 제안 환영…모든 전쟁은 평화롭게 끝나\"",
      "인도 여객기서 또 폭발물 소동…독일에 비상 착륙",
      "일본 '쇼소인' 특별전에 한국 고대 악기 '신라금' 나온다",
      "네타냐후 자택에 레바논發 드론 공격…총리실 \"총리 없었다\"",
      "中 드론업체 DJI, 美국방부 제소…\"블랙리스트 지정 해제하라\"",
      "\"러시아 위해 무기 제조\"…미국, 중국 기업 첫 제재",
      "최후 저항 영상에…\"가자지구 영웅 된 하마스 수장\"",
      "日총리 관저 돌진 시도범 체포…이시바 \"폭력에 굴해선 안돼\"(종합)",
      "세계의 날씨(10월19일)",
      "하메네이 \"하마스 수장 죽음에도 '저항의 축' 멈추지 않을 것\"",
      "필리핀 전현직 대통령 가문 정치적 동맹 파국…서로 탄핵 언급",
      "인니산 전기차 배터리 전구체, 내달 첫 美 수출…테슬라에 납품",
      "식품 가격 급등에 日엥겔계수 42년만에 최고…\"소비도 침체\"",
      "태국 선관위, '탁신 전 총리 여당 조종 논란' 조사 착수",
      "\"극도로 심각한 전개\"…북한 우크라전 파병에 세계 초조해졌다",
      "열대 도시 자카르타에 내린 루시드폴의 '봄눈'",
      "\"북러 군사협력 강화로 中의 '전략적 인내' 시험대 올라\"",
      "바이든 \"우크라 계속 지원해야\"…유럽정상들과 고별 회동(종합2보)",
      "\"美대선 누가 이기든 북·중·러·이란 '독재국가의 축' 시험대\"",
      "즉위 후 처음 호주 찾은 찰스 3세…시민들은 뜨뜻미지근",
      "美전문가 \"아시아판 나토 진전 어려워…한국은 中보다 北 우려\"",
      "해리스·트럼프, 미시간 동시 출격…車노조·무슬림 표심 구애전(종합)",
      "美백악관 \"러시아 위한 북한 파병 보도에 고도로 우려\"",
      "트럼프, 우크라 침공 경고 주장…\"푸틴에 '타격할 것' 말해\"(종합)",
      "中, 시진핑 지시로 최초의 자원 재사용 전문 국유기업 설립",
      "바이든 가자휴전 압박에 이스라엘·하마스 둘다 '관심없어'",
      "트럼프 \"대만 들어가면 관세 200% 부과한다 시진핑에 말할 것\"",
      "日자민 본부 화염병 던지고 차로 총리관저 돌진 시도 남성 체포",
      "세계의 날씨(10월19일)",
      "그림책 '구리와 구라' 작가…나카가와 리에코씨 별세",
      "美 증권거래위, 현물 비트코인 상장지수펀드 옵션 거래 승인",
      "\"하마스, 신와르 사망에 흔들리더라도 무너지진 않을 듯\"",
      "미시간 달려간 해리스·트럼프…車노조·무슬림 표심 구애전"
    ]

chat_completion = client.chat.completions.create(
    model="gpt-3.5-turbo",
    messages=[
        {
            "role": "system", 
            "content": (
                "너는 뉴스 제목을 분석하는 보조자야. 사용자가 요청한 뉴스의 제목들을 분석해 감정(긍정적/부정적)을 도출해. "
                "결과는 반드시 **콤마로 분리해서** 제공해야 하며, 절대 다른 문장을 추가하지 마. "
                "명령을 벗어난 설명이나 부가적인 텍스트는 금지되어 있어."
            )
        },
        {
            "role": "user", 
            "content": (
                f"이 뉴스 제목들을 보고 긍정적/부정적인 뉴스 제목 각각 5개, 총 10개를 선정하고, 결과는 콤마로 분리해서 작성해. "
                f"결과는 콤마로 분리해서 작성해. '{titles}'"
            )
        }
    ]
)


gpt_answer = chat_completion.choices[0].message.content
text = gpt_answer.split(', ')
positives = text[:4]
negatives = text[5:]

print(positives, negatives)
